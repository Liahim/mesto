file needs to be recreated every time

thread safety?
